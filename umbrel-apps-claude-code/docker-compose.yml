services:
  web:
    image: ubuntu:24.04
    container_name: umbrel-apps-claude-code
    restart: unless-stopped
    ports:
      - '7681:7681'
    volumes:
      - /home/umbrel/umbrel/app-data/umbrel-apps-claude-code/home:/root
      - /home/umbrel/umbrel/app-data/umbrel-apps-claude-code/projects:/projects
      - /home/umbrel:/home/umbrel
    command: >
      /bin/bash -c "
        export PATH=$$HOME/.local/bin:$$HOME/.claude/local/bin:$$PATH &&
        apt-get update -qq &&
        apt-get install -y -qq curl ttyd &&
        if ! command -v claude &>/dev/null; then
          curl -fsSL https://claude.ai/install.sh | bash;
        fi &&
        exec ttyd --port 7681 --writable bash
      "
